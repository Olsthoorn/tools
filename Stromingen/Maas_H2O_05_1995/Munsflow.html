<!DOCTYPE html>
<html>
<head>
<title>Munsflow_1.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="can-you-give-me-the-1d-verical-richards-equation-for-unsaturated-groundwater-flow">Can you give me the 1D verical Richards equation for unsaturated groundwater flow?</h1>
<p>Of course. The 1D vertical Richards equation for unsaturated groundwater flow is a partial differential equation that describes the movement of water in the unsaturated zone, or vadose zone, of the soil. It is a fundamental equation in hydrogeology and soil physics.</p>
<p>The equation is given by:</p>
<p>$$\frac{\partial \theta}{\partial t} = \frac{\partial}{\partial z} \left[ K(\psi) \left( \frac{\partial \psi}{\partial z} + 1 \right) \right]$$</p>
<p>Where:</p>
<ul>
<li>$\theta$ is the volumetric water content (unitless, m$^3$/m$^3$)</li>
<li>$\psi$ is the pressure head or matric potential (m)</li>
<li>$t$ is time (s)</li>
<li>$z$ is the vertical coordinate, positive upwards (m)</li>
<li>$K(\psi)$ is the hydraulic conductivity, which is a function of the pressure head (m/s)</li>
</ul>
<p>This is the <strong>mixed form</strong> of the Richards equation. It is called this because it uses both the volumetric water content ($\theta$) and the pressure head ($\psi$) as variables.</p>
<p><strong>Alternative Forms:</strong></p>
<p>The Richards equation can also be written in two other common forms:</p>
<p><strong>1. Head Form:</strong></p>
<p>By using the chain rule, we can express the change in volumetric water content with respect to time in terms of the pressure head:</p>
<p>$\frac{\partial \theta}{\partial t} = \frac{d\theta}{d\psi} \frac{\partial \psi}{\partial t} = C(\psi) \frac{\partial \psi}{\partial t}$</p>
<p>where $C(\psi) = \frac{d\theta}{d\psi}$ is the specific moisture capacity (1/m).</p>
<p>Substituting this into the mixed form, we get the <strong>head form</strong> of the Richards equation:</p>
<p>$$C(\psi) \frac{\partial \psi}{\partial t} = \frac{\partial}{\partial z} \left[ K(\psi) \left( \frac{\partial \psi}{\partial z} + 1 \right) \right]$$</p>
<p><strong>2. Flux Form:</strong></p>
<p>The term $q = -K(\psi) \left( \frac{\partial \psi}{\partial z} + 1 \right)$ represents the water flux, where the positive z-direction is upward. The flux form of the Richards equation is derived from the continuity equation:</p>
<p>$$\frac{\partial \theta}{\partial t} = - \frac{\partial q}{\partial z}$$</p>
<p>This form is useful for understanding the conservation of mass.</p>
<p><strong>Key Concepts:</strong></p>
<ul>
<li><strong>Unsaturated Zone:</strong> The region of the soil above the water table where the soil pores are only partially filled with water.</li>
<li><strong>Matric Potential ($\psi$):</strong> The pressure head of the soil water, which is negative in the unsaturated zone due to capillary forces and adsorption.</li>
<li><strong>Hydraulic Conductivity ($K(\psi)$):</strong> The ability of the soil to transmit water. In the unsaturated zone, it is a function of the matric potential, and it decreases as the soil becomes drier.</li>
</ul>
<p>The Richards equation is highly non-linear due to the dependence of the hydraulic conductivity on the pressure head, which makes it challenging to solve analytically. Numerical methods are typically used to solve it.</p>
<h1 id="how-about-the-lienarized-richards-equations">How about the lienarized Richards equations?</h1>
<p>You're right to ask about the linearized Richards equation, as it's a crucial step in making the equation solvable, both analytically and numerically. The original Richards equation is highly non-linear because both the hydraulic conductivity, K(ψ), and the specific moisture capacity, C(ψ), are strongly dependent on the pressure head, ψ.</p>
<p>Linearization involves making simplifying assumptions to transform this non-linear PDE into a linear one, which is much easier to solve. The most common way to do this is to approximate the non-linear hydraulic properties as constants or as linear functions.</p>
<p>Here is the 1D vertical linearized Richards equation in the head form:</p>
<p>$$C \frac{\partial \psi}{\partial t} = K \frac{\partial^2 \psi}{\partial z^2} + \frac{\partial K}{\partial z}$$</p>
<p>This looks like a standard diffusion-advection equation, which is much simpler than the original.</p>
<p><strong>Assumptions and Approximations:</strong></p>
<p>To arrive at this linearized form, several key assumptions are made:</p>
<ol>
<li>
<p><strong>Constant Hydraulic Conductivity ($K$):</strong> The most significant approximation is assuming that the hydraulic conductivity, $K$, is a constant value. In reality, $K$ can vary by several orders of magnitude as the soil moisture changes. This assumption is only valid for small changes in matric potential, where the change in $K$ is negligible. For example, it might be a reasonable approximation for a very wet soil profile where the soil is nearly saturated.</p>
</li>
<li>
<p><strong>Constant Specific Moisture Capacity ($C$):</strong> Similarly, the specific moisture capacity, $C = d\theta/d\psi$, is assumed to be a constant. This also implies a linear relationship between volumetric water content ($\theta$) and pressure head ($\psi$), which is often a crude approximation of the actual soil water retention curve.</p>
</li>
<li>
<p><strong>Linearization of the Gravity Term:</strong> The original Richards equation has a gravity term that is also a function of the hydraulic conductivity. The linearization process often simplifies this term as well.</p>
</li>
</ol>
<p><strong>Limitations of the Linearized Equation:</strong></p>
<p>The linearized Richards equation has a major drawback: it is only accurate for a very narrow range of conditions. It is not suitable for modeling situations with a wide range of moisture contents, such as infiltration into dry soil, or evaporation from a wet soil. For these cases, the non-linearities of the hydraulic properties are too significant to be ignored.</p>
<p><strong>Applications:</strong></p>
<p>Despite its limitations, the linearized Richards equation is useful in some cases, particularly for:</p>
<ul>
<li>
<p><strong>Analytical Solutions:</strong> Because of its simplicity, it is possible to find analytical solutions to the linearized Richards equation for simple boundary and initial conditions. These solutions are valuable for understanding the fundamental behavior of unsaturated flow and for benchmarking numerical models.</p>
</li>
<li>
<p><strong>Initial Estimates:</strong> The linearized equation can provide a good first-order approximation for more complex numerical models. The solution can be used as an initial guess for the more accurate, non-linear iterative solvers (like Newton or Picard methods) used in numerical simulations.</p>
</li>
</ul>
<p>In summary, the linearized Richards equation is a simplified version of the full non-linear equation, obtained by assuming constant hydraulic conductivity and specific moisture capacity. While it's not a general-purpose tool for modeling unsaturated flow, it is a valuable theoretical and pedagogical tool, and it serves as a basis for more complex numerical solutions.</p>
<h1 id="what-if-the-k-and-psi-are-linear-functions-of-theta-like-kk0--k1-theta---thetaavg-and-psi--psi0--psi1-theta---thetaavg">What if the $K$ and $\psi$ are linear functions of $\theta$, like $k=k_0 + k_1 (\theta - \theta_{avg})$ and $\psi = \psi_0 + \psi_1  (\theta - \theta_{avg})$ ?</h1>
<p>That's an excellent question that gets to the heart of how we approach solving the Richards equation in practice. Your proposed relationships, where hydraulic conductivity ($K$) and pressure head ($\psi$) are linearized with respect to volumetric water content ($\theta$), are a common and powerful approach. This is often referred to as the <strong>$\theta$-based form</strong> of the Richards equation, and it can be a more robust approach for numerical solutions than the head-based form.</p>
<p>Let's derive the linearized Richards equation using your linear relationships:</p>
<ul>
<li>
<p>$K(\theta) = K_0 + K_1 (\theta - \theta_{avg})$</p>
</li>
<li>
<p>$\psi(\theta) = \psi_0 + \psi_1 (\theta - \theta_{avg})$</p>
</li>
</ul>
<p>Where:</p>
<ul>
<li>
<p>$K_0$ and $\psi_0$ are the hydraulic conductivity and pressure head at the average water content, $\theta_{avg}$.</p>
</li>
<li>
<p>$K_1$ and $\psi_1$ are constants representing the slope of the linear relationships.</p>
</li>
</ul>
<p>We'll start with the mixed form of the Richards equation:</p>
<p>$$\frac{\partial \theta}{\partial t} = \frac{\partial}{\partial z} \left[ K(\psi) \left( \frac{\partial \psi}{\partial z} + 1 \right) \right]$$</p>
<p>Now, we need to express the right-hand side in terms of $\theta$. We can use the chain rule to relate the spatial derivatives:</p>
<p>$\frac{\partial \psi}{\partial z} = \frac{d\psi}{d\theta} \frac{\partial \theta}{\partial z}$</p>
<p>From your linear relationship, the derivative of $\psi$ with respect to $\theta$ is simply:</p>
<p>$\frac{d\psi}{d\theta} = \psi_1$</p>
<p>So, we have:</p>
<p>$\frac{\partial \psi}{\partial z} = \psi_1 \frac{\partial \theta}{\partial z}$</p>
<p>Now, let's substitute this and your linear $K(\theta)$ function into the mixed form:</p>
<p>$$\frac{\partial \theta}{\partial t} = \frac{\partial}{\partial z} \left[ (K_0 + K_1 (\theta - \theta_{avg})) \left( \psi_1 \frac{\partial \theta}{\partial z} + 1 \right) \right]$$</p>
<p>Now, we expand the product inside the brackets:</p>
<p>$$\frac{\partial \theta}{\partial t} = \frac{\partial}{\partial z} \left[ (K_0 + K_1 \theta - K_1 \theta_{avg}) (\psi_1 \frac{\partial \theta}{\partial z} + 1) \right]$$</p>
<p>$$\frac{\partial \theta}{\partial t} = \frac{\partial}{\partial z} \left[ (K_0 + K_1 \theta - K_1 \theta_{avg}) \psi_1 \frac{\partial \theta}{\partial z} + (K_0 + K_1 \theta - K_1 \theta_{avg}) \right]$$</p>
<p>Now, we apply the product rule for differentiation with respect to $z$ to both terms:</p>
<p><strong>Term 1:</strong> $\frac{\partial}{\partial z} \left[ (K_0 + K_1 \theta - K_1 \theta_{avg}) \psi_1 \frac{\partial \theta}{\partial z} \right]$</p>
<p>Let's define the diffusivity $D(\theta) = K(\theta) \frac{d\psi}{d\theta} = (K_0 + K_1 \theta - K_1 \theta_{avg}) \psi_1$.</p>
<p>This term is $\frac{\partial}{\partial z} \left[ D(\theta) \frac{\partial \theta}{\partial z} \right]$.</p>
<p>Using the product rule, this becomes:</p>
<p>$\frac{\partial D}{\partial z} \frac{\partial \theta}{\partial z} + D \frac{\partial^2 \theta}{\partial z^2}$</p>
<p>And since $D$ is a function of $\theta$, we use the chain rule again for the first part:</p>
<p>$\frac{dD}{d\theta} \frac{\partial \theta}{\partial z} \frac{\partial \theta}{\partial z} + D \frac{\partial^2 \theta}{\partial z^2} = \frac{dD}{d\theta} \left( \frac{\partial \theta}{\partial z} \right)^2 + D \frac{\partial^2 \theta}{\partial z^2}$</p>
<p>From our linear relationships, $\frac{dD}{d\theta} = K_1 \psi_1$.</p>
<p>So, Term 1 is: $K_1 \psi_1 \left( \frac{\partial \theta}{\partial z} \right)^2 + (K_0 + K_1 \theta - K_1 \theta_{avg}) \psi_1 \frac{\partial^2 \theta}{\partial z^2}$</p>
<p><strong>Term 2:</strong> $\frac{\partial}{\partial z} \left[ K_0 + K_1 \theta - K_1 \theta_{avg} \right]$</p>
<p>This is the gravity term. Since $K_0$, $K_1$, and $\theta_{avg}$ are constants, the derivative with respect to $z$ is:</p>
<p>$K_1 \frac{\partial \theta}{\partial z}$</p>
<p>Combining both terms, the linearized Richards equation in the <strong>$\theta$-based form</strong> is:</p>
<p>$$\frac{\partial \theta}{\partial t} = (K_0 + K_1 \theta - K_1 \theta_{avg}) \psi_1 \frac{\partial^2 \theta}{\partial z^2} + K_1 \psi_1 \left( \frac{\partial \theta}{\partial z} \right)^2 + K_1 \frac{\partial \theta}{\partial z}$$</p>
<p>This equation is a lot more complex than the simple linear form we saw before, but it's still simpler than the full non-linear equation. It's a <strong>diffusion-convection-reaction</strong> type equation where the coefficients are now linear functions of $\theta$.</p>
<p><strong>Further Linearization (for a simpler form):</strong></p>
<p>If we assume that the terms with the spatial derivatives of $\theta$ are small, we can simplify this even further. A common approach for this is to neglect the squared term, $\left( \frac{\partial \theta}{\partial z} \right)^2$. However, a more common and direct linearization is to assume that the coefficients are constant, as in the previous answer. If we assume a constant diffusivity, $D = K_{avg} \psi_1$, and a constant conductivity, $K_{avg}$, we get the classical diffusion-advection equation:</p>
<p>$$\frac{\partial \theta}{\partial t} = D \frac{\partial^2 \theta}{\partial z^2} + \frac{dK}{d\theta} \frac{\partial \theta}{\partial z}$$</p>
<p>where $\frac{dK}{d\theta} = K_1$ in your case. So, the simplified form is:</p>
<p>$$\frac{\partial \theta}{\partial t} = (K_{avg} \psi_1) \frac{\partial^2 \theta}{\partial z^2} + K_1 \frac{\partial \theta}{\partial z}$$</p>
<p><strong>Why this approach is useful:</strong></p>
<ul>
<li>
<p><strong>Diffusivity:</strong> The term $D(\theta) = K(\theta) \frac{d\psi}{d\theta}$ is known as the <strong>soil water diffusivity</strong>. By expressing both $K$ and $\psi$ as functions of $\theta$, you directly model the diffusivity, which can be a more physically intuitive approach.</p>
</li>
<li>
<p><strong>Mass Conservation:</strong> The $\theta$-based form is often preferred in numerical modeling because it tends to be more <strong>mass-conservative</strong>. This is a critical property for numerical solvers, as it ensures that the total amount of water in the system is conserved over time.</p>
</li>
<li>
<p><strong>Analytical Solutions:</strong> While still not as simple as the constant-coefficient linear equation, this form is more amenable to analytical solutions than the fully non-linear equation, especially for specific boundary conditions.</p>
</li>
</ul>
<p>In summary, your linear relationships lead to a more advanced, but still linearized, form of the Richards equation in terms of volumetric water content ($\theta$). This form is a powerful tool for both analytical solutions and stable numerical simulations.</p>

</body>
</html>
